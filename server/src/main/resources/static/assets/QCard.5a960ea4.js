import{j,l as ve,h as o,ab as ye,r as H,as as ke,c as S,w as G,g as Z,y as be,av as ge,ax as xe,N as J,U as W,x as qe,aE as _e,ak as X,A as Te}from"./index.7f3ba645.js";import{b as Se}from"./QTable.2a36f1bc.js";import{u as p,a as ee}from"./use-dark.4c8cd3f0.js";var Ce=j({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(l,{slots:T,emit:y}){let x=!1,q,C,k=null,b=null,h,K;function m(){q&&q(),q=null,x=!1,k!==null&&(clearTimeout(k),k=null),b!==null&&(clearTimeout(b),b=null),C!==void 0&&C.removeEventListener("transitionend",h),h=null}function $(d,_,s){_!==void 0&&(d.style.height=`${_}px`),d.style.transition=`height ${l.duration}ms cubic-bezier(.25, .8, .50, 1)`,x=!0,q=s}function F(d,_){d.style.overflowY=null,d.style.height=null,d.style.transition=null,m(),_!==K&&y(_)}function L(d,_){let s=0;C=d,x===!0?(m(),s=d.offsetHeight===d.scrollHeight?0:void 0):(K="hide",d.style.overflowY="hidden"),$(d,s,_),k=setTimeout(()=>{k=null,d.style.height=`${d.scrollHeight}px`,h=g=>{b=null,(Object(g)!==g||g.target===d)&&F(d,"show")},d.addEventListener("transitionend",h),b=setTimeout(h,l.duration*1.1)},100)}function w(d,_){let s;C=d,x===!0?m():(K="show",d.style.overflowY="hidden",s=d.scrollHeight),$(d,s,_),k=setTimeout(()=>{k=null,d.style.height=0,h=g=>{b=null,(Object(g)!==g||g.target===d)&&F(d,"hide")},d.addEventListener("transitionend",h),b=setTimeout(h,l.duration*1.1)},100)}return ve(()=>{x===!0&&m()}),()=>o(ye,{css:!1,appear:l.appear,onEnter:L,onLeave:w},T.default)}});const Ke=["none","strict","leaf","leaf-filtered"];var Ae=j({name:"QTree",props:{...p,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>Ke.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:T,emit:y}){const{proxy:x}=Z(),{$q:q}=x,C=ee(l,q),k=H({}),b=H(l.ticked||[]),h=H(l.expanded||[]);let K={};ke(()=>{K={}});const m=S(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(C.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),$=S(()=>l.selected!==void 0),F=S(()=>l.icon||q.iconSet.tree.icon),L=S(()=>l.controlColor||l.color),w=S(()=>l.textColor!==void 0?` text-${l.textColor}`:""),d=S(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),_=S(()=>l.filterMethod!==void 0?l.filterMethod:(t,i)=>{const e=i.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),s=S(()=>{const t={},i=(e,r)=>{const n=e.tickStrategy||(r?r.tickStrategy:l.tickStrategy),c=e[l.nodeKey],u=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,E=e.disabled!==!0&&$.value===!0&&e.selectable!==!1,v=e.disabled!==!0&&e.expandable!==!1,fe=n!=="none",B=n==="strict",Y=n==="leaf-filtered",P=n==="leaf"||n==="leaf-filtered";let O=e.disabled!==!0&&e.tickable!==!1;P===!0&&O===!0&&r&&r.tickable!==!0&&(O=!1);let A=e.lazy;A===!0&&k.value[c]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(A=k.value[c]);const a={key:c,parent:r,isParent:u,lazy:A,disabled:e.disabled,link:e.disabled!==!0&&(E===!0||v===!0&&(u===!0||A===!0)),children:[],matchesFilter:l.filter?_.value(e,l.filter):!0,selected:c===l.selected&&E===!0,selectable:E,expanded:u===!0?h.value.includes(c):!1,expandable:v,noTick:e.noTick===!0||B!==!0&&A&&A!=="loaded",tickable:O,tickStrategy:n,hasTicking:fe,strictTicking:B,leafFilteredTicking:Y,leafTicking:P,ticked:B===!0?b.value.includes(c):u===!0?!1:b.value.includes(c)};if(t[c]=a,u===!0&&(a.children=e[l.childrenKey].map(f=>i(f,a)),l.filter&&(a.matchesFilter!==!0?a.matchesFilter=a.children.some(f=>f.matchesFilter):a.noTick!==!0&&a.disabled!==!0&&a.tickable===!0&&Y===!0&&a.children.every(f=>f.matchesFilter!==!0||f.noTick===!0||f.tickable!==!0)===!0&&(a.tickable=!1)),a.matchesFilter===!0&&(a.noTick!==!0&&B!==!0&&a.children.every(f=>f.noTick)===!0&&(a.noTick=!0),P))){if(a.ticked=!1,a.indeterminate=a.children.some(f=>f.indeterminate===!0),a.tickable=a.tickable===!0&&a.children.some(f=>f.tickable),a.indeterminate!==!0){const f=a.children.reduce((V,he)=>he.ticked===!0?V+1:V,0);f===a.children.length?a.ticked=!0:f>0&&(a.indeterminate=!0)}a.indeterminate===!0&&(a.indeterminateNextState=a.children.every(f=>f.tickable!==!0||f.ticked!==!0))}return a};return l.nodes.forEach(e=>i(e,null)),t});G(()=>l.ticked,t=>{b.value=t}),G(()=>l.expanded,t=>{h.value=t});function g(t){const i=[].reduce,e=(r,n)=>{if(r||!n)return r;if(Array.isArray(n)===!0)return i.call(Object(n),e,r);if(n[l.nodeKey]===t)return n;if(n[l.childrenKey])return e(null,n[l.childrenKey])};return e(null,l.nodes)}function te(){return b.value.map(t=>g(t))}function le(){return h.value.map(t=>g(t))}function ie(t){return t&&s.value[t]?s.value[t].expanded:!1}function ne(){l.expanded!==void 0?y("update:expanded",[]):h.value=[]}function M(){const t=[],i=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(i))};l.nodes.forEach(i),l.expanded!==void 0?y("update:expanded",t):h.value=t}function N(t,i,e=g(t),r=s.value[t]){if(r.lazy&&r.lazy!=="loaded"){if(r.lazy==="loading")return;k.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),y("lazyLoad",{node:e,key:t,done:n=>{k.value[t]="loaded",e[l.childrenKey]=Array.isArray(n)===!0?n:[],be(()=>{const c=s.value[t];c&&c.isParent===!0&&U(t,!0)})},fail:()=>{delete k.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else r.isParent===!0&&r.expandable===!0&&U(t,i)}function U(t,i){let e=h.value;const r=l.expanded!==void 0;if(r===!0&&(e=e.slice()),i){if(l.accordion&&s.value[t]){const n=[];s.value[t].parent?s.value[t].parent.children.forEach(c=>{c.key!==t&&c.expandable===!0&&n.push(c.key)}):l.nodes.forEach(c=>{const u=c[l.nodeKey];u!==t&&n.push(u)}),n.length!==0&&(e=e.filter(c=>n.includes(c)===!1))}e=e.concat([t]).filter((n,c,u)=>u.indexOf(n)===c)}else e=e.filter(n=>n!==t);r===!0?y("update:expanded",e):h.value=e}function re(t){return t&&s.value[t]?s.value[t].ticked:!1}function z(t,i){let e=b.value;const r=l.ticked!==void 0;r===!0&&(e=e.slice()),i?e=e.concat(t).filter((n,c,u)=>u.indexOf(n)===c):e=e.filter(n=>t.includes(n)===!1),r===!0&&y("update:ticked",e)}function ae(t,i,e){const r={tree:x,node:t,key:e,color:l.color,dark:C.value};return X(r,"expanded",()=>i.expanded,n=>{n!==i.expanded&&N(e,n)}),X(r,"ticked",()=>i.ticked,n=>{n!==i.ticked&&z([e],n)}),r}function D(t){return(l.filter?t.filter(i=>s.value[i[l.nodeKey]].matchesFilter):t).map(i=>oe(i))}function de(t){if(t.icon!==void 0)return o(J,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const i=t.img||t.avatar;if(i)return o("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:i})}function ce(){y("afterShow")}function ue(){y("afterHide")}function oe(t){const i=t[l.nodeKey],e=s.value[i],r=t.header&&T[`header-${t.header}`]||T["default-header"],n=e.isParent===!0?D(t[l.childrenKey]):[],c=n.length!==0||e.lazy&&e.lazy!=="loaded";let u=t.body&&T[`body-${t.body}`]||T["default-body"];const E=r!==void 0||u!==void 0?ae(t,e,i):null;return u!==void 0&&(u=o("div",{class:"q-tree__node-body relative-position"},[o("div",{class:w.value},[u(E)])])),o("div",{key:i,class:`q-tree__node relative-position q-tree__node--${c===!0?"parent":"child"}`},[o("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,onClick:v=>{R(t,e,v)},onKeypress(v){ge(v)!==!0&&(v.keyCode===13?R(t,e,v,!0):v.keyCode===32&&Q(t,e,v,!0))}},[o("div",{class:"q-focus-helper",tabindex:-1,ref:v=>{K[e.key]=v}}),e.lazy==="loading"?o(xe,{class:"q-tree__spinner",color:L.value}):c===!0?o(J,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:F.value,onClick(v){Q(t,e,v)}}):null,e.hasTicking===!0&&e.noTick!==!0?o(Se,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:L.value,dark:C.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:W,"onUpdate:modelValue":v=>{se(e,v)}}):null,o("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?d.value:w.value)},[r?r(E):[de(t),o("div",t[l.labelKey])]])]),c===!0?l.noTransition===!0?o("div",{class:"q-tree__node-collapsible"+w.value,key:`${i}__q`},[u,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},e.expanded?n:null)]):o(Ce,{duration:l.duration,onShow:ce,onHide:ue},()=>qe(o("div",{class:"q-tree__node-collapsible"+w.value,key:`${i}__q`},[u,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},n)]),[[_e,e.expanded]])):u])}function I(t){const i=K[t];i&&i.focus()}function R(t,i,e,r){r!==!0&&i.selectable!==!1&&I(i.key),$.value&&i.selectable?l.noSelectionUnset===!1?y("update:selected",i.key!==l.selected?i.key:null):i.key!==l.selected&&y("update:selected",i.key===void 0?null:i.key):Q(t,i,e,r),typeof t.handler=="function"&&t.handler(t)}function Q(t,i,e,r){e!==void 0&&W(e),r!==!0&&i.selectable!==!1&&I(i.key),N(i.key,!i.expanded,t,i)}function se(t,i){if(t.indeterminate===!0&&(i=t.indeterminateNextState),t.strictTicking)z([t.key],i);else if(t.leafTicking){const e=[],r=n=>{n.isParent?(i!==!0&&n.noTick!==!0&&n.tickable===!0&&e.push(n.key),n.leafTicking===!0&&n.children.forEach(r)):n.noTick!==!0&&n.tickable===!0&&(n.leafFilteredTicking!==!0||n.matchesFilter===!0)&&e.push(n.key)};r(t),z(e,i)}}return l.defaultExpandAll===!0&&M(),Object.assign(x,{getNodeByKey:g,getTickedNodes:te,getExpandedNodes:le,isExpanded:ie,collapseAll:ne,expandAll:M,setExpanded:N,isTicked:re,setTicked:z}),()=>{const t=D(l.nodes);return o("div",{class:m.value},t.length===0?l.filter?l.noResultsLabel||q.lang.tree.noResults:l.noNodesLabel||q.lang.tree.noNodes:t)}}}),$e=j({name:"QCard",props:{...p,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(l,{slots:T}){const{proxy:{$q:y}}=Z(),x=ee(l,y),q=S(()=>"q-card"+(x.value===!0?" q-card--dark q-dark":"")+(l.bordered===!0?" q-card--bordered":"")+(l.square===!0?" q-card--square no-border-radius":"")+(l.flat===!0?" q-card--flat no-shadow":""));return()=>o(l.tag,{class:q.value},Te(T.default))}});export{Ce as Q,$e as a,Ae as b};
