import{j as P,r as y,B as A,t as F,u as _,o as k,h as U,A as R,g as I,a1 as T,U as B,y as $,aw as z,_ as H,H as j,G as D,J as K,K as M,L as b,d,Q as S,M as w,aa as O}from"./index.7f3ba645.js";import{a as G,Q as J}from"./QToolbar.e08e31dd.js";import{Q as C}from"./QInput.4c1fb8fe.js";import{g as L}from"./use-key-composition.450dd12f.js";import{Q as W}from"./QPage.d924841a.js";import{u as X}from"./use-quasar.c7be712f.js";import{g as Y}from"./graphql.6d0adb5b.js";import"./use-dark.4c8cd3f0.js";import"./axios.898b20c0.js";var Z=P({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(l,{slots:n,emit:f}){const a=I(),u=y(null);let i=0;const e=[];function g(o){const r=typeof o=="boolean"?o:l.noErrorFocus!==!0,v=++i,q=(t,s)=>{f("validation"+(t===!0?"Success":"Error"),s)},E=t=>{const s=t.validate();return typeof s.then=="function"?s.then(c=>({valid:c,comp:t}),c=>({valid:!1,comp:t,err:c})):Promise.resolve({valid:s,comp:t})};return(l.greedy===!0?Promise.all(e.map(E)).then(t=>t.filter(s=>s.valid!==!0)):e.reduce((t,s)=>t.then(()=>E(s).then(c=>{if(c.valid===!1)return Promise.reject(c)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return v===i&&q(!0),!0;if(v===i){const{comp:s,err:c}=t[0];if(c!==void 0&&console.error(c),q(!1,s),r===!0){const N=t.find(({comp:Q})=>typeof Q.focus=="function"&&T(Q.$)===!1);N!==void 0&&N.comp.focus()}}return!1})}function h(){i++,e.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function V(o){o!==void 0&&B(o);const r=i+1;g().then(v=>{r===i&&v===!0&&(l.onSubmit!==void 0?f("submit",o):o!==void 0&&o.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function p(o){o!==void 0&&B(o),f("reset"),$(()=>{h(),l.autofocus===!0&&l.noResetFocus!==!0&&m()})}function m(){L(()=>{if(u.value===null)return;const o=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),r=>r.tabIndex>-1);o!=null&&o.focus({preventScroll:!0})})}A(z,{bindComponent(o){e.push(o)},unbindComponent(o){const r=e.indexOf(o);r>-1&&e.splice(r,1)}});let x=!1;return F(()=>{x=!0}),_(()=>{x===!0&&l.autofocus===!0&&m()}),k(()=>{l.autofocus===!0&&m()}),Object.assign(a.proxy,{validate:g,resetValidation:h,submit:V,reset:p,focus:m,getValidationComponents:()=>e}),()=>U("form",{class:"q-form",ref:u,onSubmit:V,onReset:p},R(n.default))}});const ee={setup(){const l=j(),n=D(),f=y(n.params.id),a=X(),u=y(),i=y(),e=y(),g=y();function h(){l.back()}function V(){var p="",m=u.value,x=g.value,o=i.value,r=e.value;f.value==-1?p=`mutation {
            createConnection(name:"${x}",host:"${m}",username:"${o}",password:"${r}"){
                id
             }
          }`:p=`mutation {
            updateConnection(id:${f.value},name:"${x}",host:"${m}",username:"${o}",password:"${r}"){
                id
             }
          }`,Y(p,v=>{h()},v=>{a.notify(v)})}return{hostName:u,userName:i,password:e,connnectionName:g,goHome:h,saveConnection:V}}};function oe(l,n,f,a,u,i){return K(),M(W,null,{default:b(()=>[d(J,{class:"bg-primary text-white"},{default:b(()=>[d(S,{flat:"",round:"",dense:"",icon:"arrow_back",to:"/"}),d(G,null,{default:b(()=>[w("Add or Update Connection")]),_:1})]),_:1}),d(Z,{class:"q-pa-md q-gutter-md",onSubmit:a.saveConnection},{default:b(()=>[d(C,{filled:"",modelValue:a.connnectionName,"onUpdate:modelValue":n[0]||(n[0]=e=>a.connnectionName=e),label:"Connection name","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter a unique connection name"]},null,8,["modelValue","rules"]),d(C,{filled:"",modelValue:a.hostName,"onUpdate:modelValue":n[1]||(n[1]=e=>a.hostName=e),label:"Host","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter base url of the base server"]},null,8,["modelValue","rules"]),d(C,{filled:"",modelValue:a.userName,"onUpdate:modelValue":n[2]||(n[2]=e=>a.userName=e),label:"User name","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter BAW user login id"]},null,8,["modelValue","rules"]),d(C,{filled:"",modelValue:a.password,"onUpdate:modelValue":n[3]||(n[3]=e=>a.password=e),label:"Password",type:"password","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter password"]},null,8,["modelValue","rules"]),O("div",null,[d(S,{color:"primary",type:"submit"},{default:b(()=>[w("Save")]),_:1}),d(S,{color:"secondary",class:"q-ml-sm",onClick:a.goHome},{default:b(()=>[w("Cancel")]),_:1},8,["onClick"])])]),_:1},8,["onSubmit"])]),_:1})}var fe=H(ee,[["render",oe]]);export{fe as default};
