import{j as G,r as B,am as ve,c as v,w as U,h as o,g as J,z as ye,ap as ke,aw as be,aa as H,S as R,y as ge,ay as xe,ag as V,k as qe}from"./index.a05dc650.js";import{a as _e}from"./QTable.9c7baac6.js";import{n as Se}from"./QExpansionItem.7da6f09b.js";import{u as W,a as X}from"./use-model-toggle.763d06ad.js";const Ce=["none","strict","leaf","leaf-filtered"];var me=G({name:"QTree",props:{...W,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>Ce.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:y,emit:f}){const{proxy:q}=J(),{$q:b}=q,A=X(l,b),_=B({}),S=B(l.ticked||[]),k=B(l.expanded||[]);let m={};ve(()=>{m={}});const Y=v(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(A.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),N=v(()=>l.selected!==void 0),Z=v(()=>l.icon||b.iconSet.tree.icon),L=v(()=>l.controlColor||l.color),C=v(()=>l.textColor!==void 0?` text-${l.textColor}`:""),p=v(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),ee=v(()=>l.filterMethod!==void 0?l.filterMethod:(t,r)=>{const e=r.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),h=v(()=>{const t={},r=(e,a)=>{const i=e.tickStrategy||(a?a.tickStrategy:l.tickStrategy),c=e[l.nodeKey],d=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,g=e.disabled!==!0&&N.value===!0&&e.selectable!==!1,s=e.disabled!==!0&&e.expandable!==!1,fe=i!=="none",w=i==="strict",j=i==="leaf-filtered",F=i==="leaf"||i==="leaf-filtered";let $=e.disabled!==!0&&e.tickable!==!1;F===!0&&$===!0&&a&&a.tickable!==!0&&($=!1);let x=e.lazy;x===!0&&_.value[c]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(x=_.value[c]);const n={key:c,parent:a,isParent:d,lazy:x,disabled:e.disabled,link:e.disabled!==!0&&(g===!0||s===!0&&(d===!0||x===!0)),children:[],matchesFilter:l.filter?ee.value(e,l.filter):!0,selected:c===l.selected&&g===!0,selectable:g,expanded:d===!0?k.value.includes(c):!1,expandable:s,noTick:e.noTick===!0||w!==!0&&x&&x!=="loaded",tickable:$,tickStrategy:i,hasTicking:fe,strictTicking:w,leafFilteredTicking:j,leafTicking:F,ticked:w===!0?S.value.includes(c):d===!0?!1:S.value.includes(c)};if(t[c]=n,d===!0&&(n.children=e[l.childrenKey].map(u=>r(u,n)),l.filter&&(n.matchesFilter!==!0?n.matchesFilter=n.children.some(u=>u.matchesFilter):n.noTick!==!0&&n.disabled!==!0&&n.tickable===!0&&j===!0&&n.children.every(u=>u.matchesFilter!==!0||u.noTick===!0||u.tickable!==!0)===!0&&(n.tickable=!1)),n.matchesFilter===!0&&(n.noTick!==!0&&w!==!0&&n.children.every(u=>u.noTick)===!0&&(n.noTick=!0),F))){if(n.ticked=!1,n.indeterminate=n.children.some(u=>u.indeterminate===!0),n.tickable=n.tickable===!0&&n.children.some(u=>u.tickable),n.indeterminate!==!0){const u=n.children.reduce((I,he)=>he.ticked===!0?I+1:I,0);u===n.children.length?n.ticked=!0:u>0&&(n.indeterminate=!0)}n.indeterminate===!0&&(n.indeterminateNextState=n.children.every(u=>u.tickable!==!0||u.ticked!==!0))}return n};return l.nodes.forEach(e=>r(e,null)),t});U(()=>l.ticked,t=>{S.value=t}),U(()=>l.expanded,t=>{k.value=t});function K(t){const r=[].reduce,e=(a,i)=>{if(a||!i)return a;if(Array.isArray(i)===!0)return r.call(Object(i),e,a);if(i[l.nodeKey]===t)return i;if(i[l.childrenKey])return e(null,i[l.childrenKey])};return e(null,l.nodes)}function te(){return S.value.map(t=>K(t))}function le(){return k.value.map(t=>K(t))}function re(t){return t&&h.value[t]?h.value[t].expanded:!1}function ie(){l.expanded!==void 0?f("update:expanded",[]):k.value=[]}function P(){const t=[],r=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(r))};l.nodes.forEach(r),l.expanded!==void 0?f("update:expanded",t):k.value=t}function E(t,r,e=K(t),a=h.value[t]){if(a.lazy&&a.lazy!=="loaded"){if(a.lazy==="loading")return;_.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),f("lazyLoad",{node:e,key:t,done:i=>{_.value[t]="loaded",e[l.childrenKey]=Array.isArray(i)===!0?i:[],ye(()=>{const c=h.value[t];c&&c.isParent===!0&&Q(t,!0)})},fail:()=>{delete _.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else a.isParent===!0&&a.expandable===!0&&Q(t,r)}function Q(t,r){let e=k.value;const a=l.expanded!==void 0;if(a===!0&&(e=e.slice()),r){if(l.accordion&&h.value[t]){const i=[];h.value[t].parent?h.value[t].parent.children.forEach(c=>{c.key!==t&&c.expandable===!0&&i.push(c.key)}):l.nodes.forEach(c=>{const d=c[l.nodeKey];d!==t&&i.push(d)}),i.length!==0&&(e=e.filter(c=>i.includes(c)===!1))}e=e.concat([t]).filter((i,c,d)=>d.indexOf(i)===c)}else e=e.filter(i=>i!==t);a===!0?f("update:expanded",e):k.value=e}function ae(t){return t&&h.value[t]?h.value[t].ticked:!1}function T(t,r){let e=S.value;const a=l.ticked!==void 0;a===!0&&(e=e.slice()),r?e=e.concat(t).filter((i,c,d)=>d.indexOf(i)===c):e=e.filter(i=>t.includes(i)===!1),a===!0&&f("update:ticked",e)}function ne(t,r,e){const a={tree:q,node:t,key:e,color:l.color,dark:A.value};return V(a,"expanded",()=>r.expanded,i=>{i!==r.expanded&&E(e,i)}),V(a,"ticked",()=>r.ticked,i=>{i!==r.ticked&&T([e],i)}),a}function M(t){return(l.filter?t.filter(r=>h.value[r[l.nodeKey]].matchesFilter):t).map(r=>oe(r))}function ce(t){if(t.icon!==void 0)return o(H,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const r=t.img||t.avatar;if(r)return o("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:r})}function de(){f("afterShow")}function ue(){f("afterHide")}function oe(t){const r=t[l.nodeKey],e=h.value[r],a=t.header&&y[`header-${t.header}`]||y["default-header"],i=e.isParent===!0?M(t[l.childrenKey]):[],c=i.length!==0||e.lazy&&e.lazy!=="loaded";let d=t.body&&y[`body-${t.body}`]||y["default-body"];const g=a!==void 0||d!==void 0?ne(t,e,r):null;return d!==void 0&&(d=o("div",{class:"q-tree__node-body relative-position"},[o("div",{class:C.value},[d(g)])])),o("div",{key:r,class:`q-tree__node relative-position q-tree__node--${c===!0?"parent":"child"}`},[o("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,onClick:s=>{D(t,e,s)},onKeypress(s){ke(s)!==!0&&(s.keyCode===13?D(t,e,s,!0):s.keyCode===32&&z(t,e,s,!0))}},[o("div",{class:"q-focus-helper",tabindex:-1,ref:s=>{m[e.key]=s}}),e.lazy==="loading"?o(be,{class:"q-tree__spinner",color:L.value}):c===!0?o(H,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:Z.value,onClick(s){z(t,e,s)}}):null,e.hasTicking===!0&&e.noTick!==!0?o(_e,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:L.value,dark:A.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:R,"onUpdate:modelValue":s=>{se(e,s)}}):null,o("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?p.value:C.value)},[a?a(g):[ce(t),o("div",t[l.labelKey])]])]),c===!0?l.noTransition===!0?o("div",{class:"q-tree__node-collapsible"+C.value,key:`${r}__q`},[d,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},e.expanded?i:null)]):o(Se,{duration:l.duration,onShow:de,onHide:ue},()=>ge(o("div",{class:"q-tree__node-collapsible"+C.value,key:`${r}__q`},[d,o("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},i)]),[[xe,e.expanded]])):d])}function O(t){const r=m[t];r&&r.focus()}function D(t,r,e,a){a!==!0&&r.selectable!==!1&&O(r.key),N.value&&r.selectable?l.noSelectionUnset===!1?f("update:selected",r.key!==l.selected?r.key:null):r.key!==l.selected&&f("update:selected",r.key===void 0?null:r.key):z(t,r,e,a),typeof t.handler=="function"&&t.handler(t)}function z(t,r,e,a){e!==void 0&&R(e),a!==!0&&r.selectable!==!1&&O(r.key),E(r.key,!r.expanded,t,r)}function se(t,r){if(t.indeterminate===!0&&(r=t.indeterminateNextState),t.strictTicking)T([t.key],r);else if(t.leafTicking){const e=[],a=i=>{i.isParent?(r!==!0&&i.noTick!==!0&&i.tickable===!0&&e.push(i.key),i.leafTicking===!0&&i.children.forEach(a)):i.noTick!==!0&&i.tickable===!0&&(i.leafFilteredTicking!==!0||i.matchesFilter===!0)&&e.push(i.key)};a(t),T(e,r)}}return l.defaultExpandAll===!0&&P(),Object.assign(q,{getNodeByKey:K,getTickedNodes:te,getExpandedNodes:le,isExpanded:re,collapseAll:ie,expandAll:P,setExpanded:E,isTicked:ae,setTicked:T}),()=>{const t=M(l.nodes);return o("div",{class:Y.value},t.length===0?l.filter?l.noResultsLabel||b.lang.tree.noResults:l.noNodesLabel||b.lang.tree.noNodes:t)}}}),Ee=G({name:"QCard",props:{...W,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(l,{slots:y}){const{proxy:{$q:f}}=J(),q=X(l,f),b=v(()=>"q-card"+(q.value===!0?" q-card--dark q-dark":"")+(l.bordered===!0?" q-card--bordered":"")+(l.square===!0?" q-card--square no-border-radius":"")+(l.flat===!0?" q-card--flat no-shadow":""));return()=>o(l.tag,{class:b.value},qe(y.default))}});export{Ee as Q,me as a};
