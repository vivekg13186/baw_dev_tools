import{Q as U,a as D}from"./QBreadcrumbs.91b38f9a.js";import{j as P,r as i,c as S,w as $,h as x,y as M,x as F,s as H,g as G,v as J,_ as K,G as W,E as X,o as Y,H as Z,I as ee,J as ae,K as n,d as o,a8 as T,aa as I,a9 as y,L as Q}from"./index.167deede.js";import{Q as L}from"./QInput.1a364c03.js";import{Q as E}from"./QTd.ca91323a.js";import{Q as O}from"./QTable.bd34a3e1.js";import{T as te}from"./TouchPan.2f8eeca4.js";import{u as le,a as oe}from"./use-model-toggle.62d09ea2.js";import{Q as re}from"./QExpansionItem.a31b225d.js";import{api as j}from"./axios.1a6ecca9.js";import{u as ne}from"./use-quasar.c4868bab.js";import{c as R}from"./baw_api.182cf9e2.js";import"./use-timeout.2d9f1d40.js";import"./touch.3df10340.js";var se=P({name:"QSplitter",props:{...le,modelValue:{type:Number,required:!0},reverse:Boolean,unit:{type:String,default:"%",validator:e=>["%","px"].includes(e)},limits:{type:Array,validator:e=>e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"?!1:e[0]>=0&&e[0]<=e[1]},emitImmediately:Boolean,horizontal:Boolean,disable:Boolean,beforeClass:[Array,String,Object],afterClass:[Array,String,Object],separatorClass:[Array,String,Object],separatorStyle:[Array,String,Object]},emits:["update:modelValue"],setup(e,{slots:r,emit:g}){const{proxy:{$q:a}}=G(),k=oe(e,a),c=i(null),m={before:i(null),after:i(null)},l=S(()=>`q-splitter no-wrap ${e.horizontal===!0?"q-splitter--horizontal column":"q-splitter--vertical row"} q-splitter--${e.disable===!0?"disabled":"workable"}`+(k.value===!0?" q-splitter--dark":"")),p=S(()=>e.horizontal===!0?"height":"width"),b=S(()=>e.reverse!==!0?"before":"after"),d=S(()=>e.limits!==void 0?e.limits:e.unit==="%"?[10,90]:[50,1/0]);function f(s){return(e.unit==="%"?s:Math.round(s))+e.unit}const _=S(()=>({[b.value]:{[p.value]:f(e.modelValue)}}));let q,V,A,C,v;function z(s){if(s.isFirst===!0){const u=c.value.getBoundingClientRect()[p.value];q=e.horizontal===!0?"up":"left",V=e.unit==="%"?100:u,A=Math.min(V,d.value[1],Math.max(d.value[0],e.modelValue)),C=(e.reverse!==!0?1:-1)*(e.horizontal===!0?1:a.lang.rtl===!0?-1:1)*(e.unit==="%"?u===0?0:100/u:1),c.value.classList.add("q-splitter--active");return}if(s.isFinal===!0){v!==e.modelValue&&g("update:modelValue",v),c.value.classList.remove("q-splitter--active");return}const t=A+C*(s.direction===q?-1:1)*s.distance[e.horizontal===!0?"y":"x"];v=Math.min(V,d.value[1],Math.max(d.value[0],t)),m[b.value].value.style[p.value]=f(v),e.emitImmediately===!0&&e.modelValue!==v&&g("update:modelValue",v)}const B=S(()=>[[te,z,void 0,{[e.horizontal===!0?"vertical":"horizontal"]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function w(s,t){s<t[0]?g("update:modelValue",t[0]):s>t[1]&&g("update:modelValue",t[1])}return $(()=>e.modelValue,s=>{w(s,d.value)}),$(()=>e.limits,()=>{J(()=>{w(e.modelValue,d.value)})}),()=>{const s=[x("div",{ref:m.before,class:["q-splitter__panel q-splitter__before"+(e.reverse===!0?" col":""),e.beforeClass],style:_.value.before},M(r.before)),x("div",{class:["q-splitter__separator",e.separatorClass],style:e.separatorStyle,"aria-disabled":e.disable===!0?"true":void 0},[F("div",{class:"q-splitter__separator-area absolute-full"},M(r.separator),"sep",e.disable!==!0,()=>B.value)]),x("div",{ref:m.after,class:["q-splitter__panel q-splitter__after"+(e.reverse===!0?"":" col"),e.afterClass],style:_.value.after},M(r.after))];return x("div",{class:l.value,ref:c},H(r.default,s))}}});const ie=[{name:"appName",required:!0,label:"App name",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"shortName",required:!0,label:"ID",align:"left",field:e=>e.shortName,format:e=>`${e}`,sortable:!0},{name:"defaultBranch",required:!0,label:"Default Branch",align:"left",field:e=>e.defaultVersion,format:e=>`${e}`,sortable:!0},{name:"count",required:!0,label:"Snapshot Count",align:"left",field:e=>e.installedSnapshots?e.installedSnapshots.length:"",format:e=>`${e}`,sortable:!0},{name:"actions",align:"left",label:"Actions"}],ue=[{name:"snapshotName",required:!0,label:"Snapshot name",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0},{name:"shortName",required:!0,label:"ID",align:"left",field:e=>e.acronym,format:e=>`${e}`,sortable:!0},{name:"branchName",required:!0,label:"Branch",align:"left",field:e=>e.branchName,format:e=>`${e}`,sortable:!0},{name:"createdOn",required:!0,label:"Created On",align:"left",field:e=>e.createdOn,format:e=>`${e}`,sortable:!0},{name:"active",field:e=>e.active,format:e=>`${e}`,label:"Active",align:"left",sortable:!0},{name:"actions",align:"left",label:"Actions"}],de={setup(){const e=ne(),r=W(),g=X(),a=i(g.params.id),k=i([]),c=i([]),m=i(!0),l=i(!0),p=i(50),b=i([]),d=i(""),f=i([]),_=i(""),q=i(""),V=i(""),A=i("");function C(){j.get(`api/getToolkits/${a.value}`).then(t=>{console.log(t.data.data.processAppsList),l.value=!1;var u=t.data.data.processAppsList;c.value.splice(0,c.value.length,...u)}).catch(t=>{console.log(t),e.notify("Error loading toolkits"),l.value=!1})}function v(){j.get(`api/getApps/${a.value}`).then(t=>{console.log(t.data.data.processAppsList),m.value=!1;var u=t.data.data.processAppsList;k.value.splice(0,k.value.length,...u)}).catch(t=>{console.log(t),e.notify("Error loading apps"),m.value=!1})}function z(t){d.value=`${t.name}(${t.shortName})`,_.value=t.shortName,b.value.splice(0,b.value.length,...t.installedSnapshots)}function B(t){r.push({name:"viewSnapshot",query:{con:a.value,appName:d.value,appSName:_.value,snapId:t.ID,snapSName:t.acronym,snapName:t.name}})}function w(t){for(var u=f.value,h=0;h<u.length;h++){var N=u[h].acronym;console.log(u[h]),R(a.value,_.value,N,t,`Error ${t} snapshot ${N}`,function(ve){e.notify(`${t} snapshot ${N}`)})}}function s(){var t=f.value,u="make_default";if(t.length==1){var h=t[0].acronym;R(a.value,_.value,h,u,`Error ${u} snapshot ${h}`,function(N){e.notify(`${u} snapshot ${h}`)})}else e.notify("Make default need single selection")}return Y(()=>{v(),C()}),{connection:a,loading_toolkits:l,columns:ie,apps:k,loading_apps:m,toolkits:c,splitterModel:p,showSnapshots:z,snapshot_columns:ue,snapshots:b,selected_app:d,selected:f,openSnapshotPage:B,filter1:q,filter3:A,filter2:V,makeDefault:s,doAction:w,getSelectedString(){return f.value.length===0?"":`${f.value.length} record${f.value.length>1?"s":""} selected of ${b.value.length}`}}}},ce={class:"q-pa-md q-gutter-md"},me={class:"q-pa-sm q-gutter-lg"},fe={class:"q-pa-sm q-gutter-md"};function pe(e,r,g,a,k,c){const m=Z("qpage");return ee(),ae(m,{padding:""},{default:n(()=>[o(re,{"expand-separator":"",label:"Applications and Toolkits","hide-expand-icon":"","default-opened":"","header-class":"bg-primary text-white"},{default:n(()=>[T("div",ce,[o(U,null,{default:n(()=>[o(D,{label:"Home",to:"/"}),o(D,{label:a.connection},null,8,["label"]),o(D,{label:"Apps & Toolkits"})]),_:1}),o(se,{modelValue:a.splitterModel,"onUpdate:modelValue":r[7]||(r[7]=l=>a.splitterModel=l)},{before:n(()=>[o(O,{title:"Applications",rows:a.apps,columns:a.columns,"row-key":"name",loading:a.loading_apps,filter:a.filter1},{"top-right":n(()=>[o(L,{borderless:"",dense:"",debounce:"300",modelValue:a.filter1,"onUpdate:modelValue":r[0]||(r[0]=l=>a.filter1=l),placeholder:"Search"},{append:n(()=>[o(I,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(l=>[o(E,{props:l},{default:n(()=>[o(y,{flat:"",color:"primary",size:"sm",label:"View Snapshots",onClick:p=>a.showSnapshots(l.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","filter"]),o(O,{title:"Toolkits",rows:a.toolkits,columns:a.columns,"row-key":"name",loading:a.loading_toolkits,filter:a.filter2},{"top-right":n(()=>[o(L,{borderless:"",dense:"",debounce:"300",modelValue:a.filter2,"onUpdate:modelValue":r[1]||(r[1]=l=>a.filter2=l),placeholder:"Search"},{append:n(()=>[o(I,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(l=>[o(E,{props:l},{default:n(()=>[o(y,{flat:"",color:"primary",size:"sm",label:"View Snapshots",onClick:p=>a.showSnapshots(l.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","filter"])]),after:n(()=>[T("div",me,[T("div",fe,[o(y,{color:"primary",onClick:a.makeDefault},{default:n(()=>[Q("Make Default")]),_:1},8,["onClick"]),o(y,{color:"primary",onClick:r[2]||(r[2]=l=>a.doAction("activate"))},{default:n(()=>[Q("Activate")]),_:1}),o(y,{color:"primary",onClick:r[3]||(r[3]=l=>a.doAction("deactivate"))},{default:n(()=>[Q("DeActivate")]),_:1}),o(y,{color:"primary",onClick:r[4]||(r[4]=l=>a.doAction("archive"))},{default:n(()=>[Q("Archive")]),_:1})]),o(O,{title:"Snapshots - "+a.selected_app,rows:a.snapshots,columns:a.snapshot_columns,"row-key":"acronym",selection:"multiple","selected-rows-label":a.getSelectedString,selected:a.selected,"onUpdate:selected":r[6]||(r[6]=l=>a.selected=l),filter:a.filter3},{"top-right":n(()=>[o(L,{borderless:"",dense:"",debounce:"300",modelValue:a.filter3,"onUpdate:modelValue":r[5]||(r[5]=l=>a.filter3=l),placeholder:"Search"},{append:n(()=>[o(I,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-actions":n(l=>[o(E,{key:"action",props:l},{default:n(()=>[o(y,{flat:"",color:"primary",size:"sm",label:"View Config",onClick:p=>a.openSnapshotPage(l.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["title","rows","columns","selected-rows-label","selected","filter"])])]),_:1},8,["modelValue"])])]),_:1})]),_:1})}var xe=K(de,[["render",pe]]);export{xe as default};
