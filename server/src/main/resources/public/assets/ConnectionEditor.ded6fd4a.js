import{Q as h}from"./QInput.9bc2df02.js";import{j as k,r as v,B as F,u as P,v as _,o as A,h as I,k as U,g as z,a0 as R,S as w,z as H,av as j,_ as D,H as K,I as M,J as O,K as T,L as p,d as f,a9 as J,Q as B,M as Q}from"./index.a05dc650.js";import{e as L,Q as W}from"./QExpansionItem.7da6f09b.js";import{api as G}from"./axios.d8311e7a.js";import{u as X}from"./use-quasar.3bf949c1.js";import"./use-model-toggle.763d06ad.js";var Y=k({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(r,{slots:a,emit:m}){const n=z(),u=v(null);let i=0;const s=[];function e(o){const c=typeof o=="boolean"?o:r.noErrorFocus!==!0,g=++i,S=(t,l)=>{m("validation"+(t===!0?"Success":"Error"),l)},E=t=>{const l=t.validate();return typeof l.then=="function"?l.then(d=>({valid:d,comp:t}),d=>({valid:!1,comp:t,err:d})):Promise.resolve({valid:l,comp:t})};return(r.greedy===!0?Promise.all(s.map(E)).then(t=>t.filter(l=>l.valid!==!0)):s.reduce((t,l)=>t.then(()=>E(l).then(d=>{if(d.valid===!1)return Promise.reject(d)})),Promise.resolve()).catch(t=>[t])).then(t=>{if(t===void 0||t.length===0)return g===i&&S(!0),!0;if(g===i){const{comp:l,err:d}=t[0];if(d!==void 0&&console.error(d),S(!1,l),c===!0){const N=t.find(({comp:q})=>typeof q.focus=="function"&&R(q.$)===!1);N!==void 0&&N.comp.focus()}}return!1})}function b(){i++,s.forEach(o=>{typeof o.resetValidation=="function"&&o.resetValidation()})}function x(o){o!==void 0&&w(o);const c=i+1;e().then(g=>{c===i&&g===!0&&(r.onSubmit!==void 0?m("submit",o):o!==void 0&&o.target!==void 0&&typeof o.target.submit=="function"&&o.target.submit())})}function V(o){o!==void 0&&w(o),m("reset"),H(()=>{b(),r.autofocus===!0&&r.noResetFocus!==!0&&y()})}function y(){L(()=>{if(u.value===null)return;const o=u.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||u.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||u.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(u.value.querySelectorAll("[tabindex]"),c=>c.tabIndex>-1);o!=null&&o.focus({preventScroll:!0})})}F(j,{bindComponent(o){s.push(o)},unbindComponent(o){const c=s.indexOf(o);c>-1&&s.splice(c,1)}});let C=!1;return P(()=>{C=!0}),_(()=>{C===!0&&r.autofocus===!0&&y()}),A(()=>{r.autofocus===!0&&y()}),Object.assign(n.proxy,{validate:e,resetValidation:b,submit:x,reset:V,focus:y,getValidationComponents:()=>s}),()=>I("form",{class:"q-form",ref:u,onSubmit:x,onReset:V},U(a.default))}});const Z={setup(){const r=X(),a=K(),m=v(),n=v(),u=v(),i=v();function s(){a.back()}function e(){G.post("/api/saveConnection",{host:m.value,name:i.value,username:n.value,password:u.value}).then(b=>{r.notify("New connection created"),a.back()}).catch(b=>{r.notify("Error occured while connection created")})}return{hostName:m,userName:n,password:u,connnectionName:i,goHome:s,saveConnection:e}}};function $(r,a,m,n,u,i){const s=M("qpage");return O(),T(s,{padding:""},{default:p(()=>[f(W,{"expand-separator":"",label:"Add or Update Connection","hide-expand-icon":"","default-opened":"","header-class":"bg-primary text-white"},{default:p(()=>[f(Y,{class:"q-pa-md q-gutter-md",onSubmit:n.saveConnection},{default:p(()=>[f(h,{filled:"",modelValue:n.connnectionName,"onUpdate:modelValue":a[0]||(a[0]=e=>n.connnectionName=e),label:"Connection name","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter a unique connection name"]},null,8,["modelValue","rules"]),f(h,{filled:"",modelValue:n.hostName,"onUpdate:modelValue":a[1]||(a[1]=e=>n.hostName=e),label:"Host","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter base url of the base server"]},null,8,["modelValue","rules"]),f(h,{filled:"",modelValue:n.userName,"onUpdate:modelValue":a[2]||(a[2]=e=>n.userName=e),label:"User name","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter BAW user login id"]},null,8,["modelValue","rules"]),f(h,{filled:"",modelValue:n.password,"onUpdate:modelValue":a[3]||(a[3]=e=>n.password=e),label:"Password",type:"password","lazy-rules":"",rules:[e=>e&&e.length>0||"Enter password"]},null,8,["modelValue","rules"]),J("div",null,[f(B,{color:"primary",type:"submit"},{default:p(()=>[Q("Save")]),_:1}),f(B,{color:"secondary",class:"q-ml-sm",onClick:n.goHome},{default:p(()=>[Q("Cancel")]),_:1},8,["onClick"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})}var le=D(Z,[["render",$]]);export{le as default};
